Ext.define("Jarvus.proxy.Postgrest",{extend:"Ext.data.proxy.Rest",alternateClassName:"Jarvus.proxy.PostgrestProxy",alias:"proxy.postgrest",config:{appendId:true,batchActions:true,actionMethods:{create:"POST",read:"GET",update:"PATCH",destroy:"DELETE"},nullsFirst:false,nullsLast:false,remoteSort:true,remoteFilter:true},sortParam:"order",buildUrl:function(f){var h=this,e=f.getOperation(),c=e.getRecords(),g=c?c[0]:null,i=h.getFormat(),a=h.getUrl(f),b,d;if(g&&!g.phantom){b=g.getId()}else{b=e.getId()}if(h.getAppendId()&&h.isValidId(b)&&!e.node.isRoot()){if(!a.match(h.slashRe)){a+="/"}a+=encodeURIComponent(b);d=f.getParams();if(d){delete d[h.getIdParam()]}}if(i){if(!a.match(h.periodRe)){a+="."}a+=i}f.setUrl(a);return h.callParent([f])},doRequest:function(a){var c=this,b;b=c.callParent([a]);b.setConfig({headers:c.getHeaders(a)});return c.sendRequest(b)},encodeSorters:function(a){return a.map(function(c){var b=c.property;if(c.direction){b+="."+c.direction.toLowerCase()}if(c.nullsFirst){b+=".nullsfirst"}if(c.nullsLast){b+=".nullslast"}return b}).join(",")},filterOperators:["eq","gt","lt","gte","lte","neq","like","ilike","is","isnot","in"],encodeFilters:function(c,b){var a=this;return b.reduce(function(h,e){var d=e.operator||"eq",g=e.property,f=e.value;if(d&&a.filterOperators.indexOf(d)===-1){Ext.Error.raise(e+"is not in the list of supported filter operators: "+a.filterOperators.join(","))}if(d==="in"&&Ext.isArray(f)){f=f.join(",")}b[g]=d+"."+f;return h},c)},getParams:function(f){if(!f.isReadOperation){return{}}var k=this,e={},a=f.getGrouper(),j=f.getSorters(),l=k.getSimpleSortMode(),m=k.getSimpleGroupMode(),h=k.getGroupParam(),i=k.getGroupDirectionParam(),c=k.getSortParam(),b=k.getDirectionParam(),d,g;d=h&&a;if(d){if(m){e[h]=a.getProperty();e[i]=a.getDirection()}else{e[h]=k.encodeSorters([a],true)}}if(c&&j&&j.length>0){if(l){g=0;if(j.length>1&&d){g=1}e[c]=j[g].getProperty();e[b]=j[g].getDirection()}else{e[c]=k.encodeSorters(j)}}filters.encodeFilters(f.getFilters(),e);return e},getHeaders:function(b){var c=this,e=c.headers,d=b.getPage(),f=b.getStart(),a=b.getLimit();if(a&&d){e["Range-Unit"]="items";e.Range=((d-1)*a)+"-"+(f+a)}else{if(f||f===0||a){e["Range-Unit"]="items";e.Range=(f||0)+"-"+(a||"")}}return c.headers}});